"Pozycja: ", Rank))
gg <- ggdane %>%
ggplot(aes(x=Year,y=Rank,color=Genre,data_id=Genre,group=Genre,label=Genre))+
scale_x_continuous(breaks=seq(1980,2016,by=1))+
scale_y_reverse(breaks=seq(12,1,by=-1))+
#geom_hline(yintercept = seq(1,12,by=1), linetype = "dashed", color = "black", alpha = 0.4, size=0.7)+
geom_line_interactive(size = 1.2,
alpha = 0.4) +
geom_point_interactive(
aes(tooltip = texto), #specifies tooltip for ggiraph
fill = "white",
size = 2.5,
stroke = 1.5,
shape = 21) +
geom_text_interactive(data = ggdane %>%
group_by(Genre) %>%
filter(Year == max(Year)),
aes(x = Year + 1.1, y = Rank,
color = Genre,
label = Genre),
check_overlap = T)+
labs(y = NULL, x = "Rok publikacji") +
theme_classic(base_size = 20)+
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)
,plot.title = element_text(color = "black", size = 22, face = "bold")
,plot.subtitle = element_text(size = 25, face = "bold")
,plot.caption = element_text(face = "italic")
,legend.position = "none"
)
girafe(ggobj = gg,
width_svg = 21, height_svg = 10, #sizes the output plot
options = list(
opts_tooltip(
opacity = 0.8, #opacity of the background box
css = "background-color:#4c6061; color:white; padding:10px; border-radius:5px;"),
opts_hover_inv(css = "stroke-width: 1;opacity:0.6;"),
opts_hover(css = "stroke-width: 4; opacity: 1;")
)
)
# game_sales[which(game_sales$Genre=="Puzzle"&game_sales$Year==1982),]
# game_sales[which(game_sales$Genre=="Shooter"&game_sales$Year==1984),]
# game_sales[which(game_sales$Genre=="Platform"&game_sales$Year==1985),]
# game_sales[which(game_sales$Genre=="Action"&game_sales$Year==1986),]
# game_sales[which(game_sales$Genre=="Platform"&game_sales$Year==1988),]
#interaktywny
ggdane <- game_sales %>%
select(Year,Genre,Global_Sales) %>%
aggregate(.~Genre+Year, FUN = sum, drop = FALSE) %>%
group_by(Year) %>%
arrange(Year,desc(Global_Sales)) %>%
# complete(Genre, fill=list(Global_Sales = 0)) %>%
# mutate(Rank=round(13-rank(Global_Sales,na.last = TRUE,ties.method="last"))) %>%
mutate(Rank=row_number(Year)) %>%
ungroup() %>%
mutate(texto = paste0(Genre, "\n",
Year, ": ",
format(round(Global_Sales*1000000, 0),
big.mark = ","), "\n",
"Pozycja: ", Rank))
gg <- ggdane %>%
ggplot(aes(x=Year,y=Rank,color=Genre,data_id=Genre,group=Genre,label=Genre))+
scale_x_continuous(breaks=seq(1980,2016,by=1))+
scale_y_reverse(breaks=seq(12,1,by=-1))+
#geom_hline(yintercept = seq(1,12,by=1), linetype = "dashed", color = "black", alpha = 0.4, size=0.7)+
geom_line_interactive(size = 1.2,
alpha = 0.4) +
geom_point_interactive(
aes(tooltip = texto), #specifies tooltip for ggiraph
fill = "white",
size = 2.5,
stroke = 1.5,
shape = 21) +
geom_text_interactive(data = ggdane %>%
group_by(Genre) %>%
filter(Year == max(Year)),
aes(x = Year + 1.1, y = Rank,
color = Genre,
label = Genre),
check_overlap = T)+
labs(y = NULL, x = "Rok publikacji") +
theme_classic(base_size = 20)+
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)
,plot.title = element_text(color = "black", size = 22, face = "bold")
,plot.subtitle = element_text(size = 25, face = "bold")
,plot.caption = element_text(face = "italic")
,legend.position = "none"
)
girafe(ggobj = gg,
width_svg = 21, height_svg = 10, #sizes the output plot
options = list(
opts_tooltip(
opacity = 0.8, #opacity of the background box
css = "background-color:#4c6061; color:white; padding:10px; border-radius:5px;"),
opts_hover_inv(css = "stroke-width: 1;opacity:0.6;"),
opts_hover(css = "stroke-width: 4; opacity: 1;")
)
)
# game_sales[which(game_sales$Genre=="Puzzle"&game_sales$Year==1982),]
# game_sales[which(game_sales$Genre=="Shooter"&game_sales$Year==1984),]
# game_sales[which(game_sales$Genre=="Platform"&game_sales$Year==1985),]
# game_sales[which(game_sales$Genre=="Action"&game_sales$Year==1986),]
# game_sales[which(game_sales$Genre=="Platform"&game_sales$Year==1988),]
rm(list = c('ggdane','gg'))
library(forcats) #do tworzenia 'others'
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup()
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
count(Platform = fct_collapse(Platform, Other = unique(Platform[Sales<sum(Sales)/100])),wt = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
count(Platform = fct_collapse(Platform, Other = unique(Platform[Sales<sum(Sales)/100])),wt = Sales) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier"
) %>%
hc_title(
text = "Udział platform w rynku growym w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
count(as.string(Platform) = fct_collapse(as.string(Platform), Other = unique(Platform[Sales<sum(Sales)/100])),wt = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
count(Platform = fct_collapse(as.string(Platform), Other = unique(as.string(Platform)[Sales<sum(Sales)/100])),wt = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
count(Platform = fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
sum(Platform = fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
#aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
sum(Platform = fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
#aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
sum(Platform = fct_collapse(as.factor(Platform), Other = unique(Platform[Sales<sum(Sales)/100])),wt = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
#aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
sum(Platform = fct_collapse(Platform, Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
#aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
sum(Platform = fct_collapse(Platform, Other = unique(Platform[Sales<sum(Sales)/100])),wt = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
#aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
count(Platform = fct_collapse(Platform, Other = unique(Platform[Sales<sum(Sales)/100])),wt = Sales, name = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
#aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
count(Platform = fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
count(Platform = fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
count(Platform = fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales) %>%
arrange(desc(Sales),Platform) %>%
ungroup()
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
#count(Platform = fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales) %>%
fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])) %>%
arrange(desc(Sales),Platform)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
#count(Platform = fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales) %>%
mutate(Sales_grp = as.factor(Platform) %>%
forcats::fct_lump_min(min = 5, other_level = "Other")) %>%
count(Sales_grp, sort = TRUE) %>%
.
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
mutate(Sales_grp = as.factor(Platform) %>%
forcats::fct_lump_min(min = 5, other_level = "Other")) %>%
count(Sales_grp, sort = TRUE)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
#count(Platform = fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales) %>%
mutate(Sales_grp = as.factor(Platform) %>%
forcats::fct_lump_min(min = 5, other_level = "Other")) %>%
count(Sales_grp, sort = TRUE)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
#count(Platform = fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales) %>%
mutate(Sales_grp = as.factor(Platform) %>%
forcats::fct_lump_min(min = 5, other_level = "Other")) %>%
sum(Sales_grp, sort = TRUE)
game_sales %>%
mutate(Sales=Global_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
#count(Platform = fct_collapse(as.factor(Platform), Other = unique(as.factor(Platform)[Sales<sum(Sales)/100])),wt = Sales) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier"
) %>%
hc_title(
text = "Udział platform w rynku growym w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
plot1 <- game_sales %>%
mutate(Sales=NA_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier w Ameryce Północnej"
) %>%
hc_title(
text = "Udział platform w Ameryce Północnej w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
plot2 <- game_sales %>%
mutate(Sales=EU_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier w Europie"
) %>%
hc_title(
text = "Udział platform w Europie w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
plot3 <- game_sales %>%
mutate(Sales=JP_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
head()
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier w Japonii"
) %>%
hc_title(
text = "Udział platform w Japonii w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
plot3 <- game_sales %>%
mutate(Sales=JP_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform)
game_sales %>%
mutate(Sales=JP_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform)
plot3 <- game_sales %>%
mutate(Sales=JP_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
head()
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier w Japonii"
) %>%
hc_title(
text = "Udział platform w Japonii w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
plot3 <- game_sales %>%
mutate(Sales=JP_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier w Japonii"
) %>%
hc_title(
text = "Udział platform w Japonii w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
plot1 <- game_sales %>%
mutate(Sales=NA_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier w Ameryce Północnej"
) %>%
hc_title(
text = "Udział platform w Ameryce Północnej w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
plot2 <- game_sales %>%
mutate(Sales=EU_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier w Europie"
) %>%
hc_title(
text = "Udział platform w Europie w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
plot3 <- game_sales %>%
mutate(Sales=JP_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier w Japonii"
) %>%
hc_title(
text = "Udział platform w Japonii w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
par(mfrow=c(3,1))
plot1
plot2
plot3
par(mfrow=c(1,1))
rm(list = c('plot1','plot2','plot3'))
par(mfrow=c(3,1))
game_sales %>%
mutate(Sales=NA_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier w Ameryce Północnej"
) %>%
hc_title(
text = "Udział platform w Ameryce Północnej w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
game_sales %>%
mutate(Sales=EU_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier w Europie"
) %>%
hc_title(
text = "Udział platform w Europie w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
game_sales %>%
mutate(Sales=JP_Sales*10000000) %>%
select(Platform,Sales) %>%
aggregate(.~Platform, FUN = sum, drop = FALSE) %>%
group_by(Platform) %>%
arrange(desc(Sales),Platform) %>%
ungroup() %>%
mutate(texto = paste0(Platform," ",
round(Sales/sum(Sales)*100,2),"%")) %>%
hchart("pie",
hcaes(x = texto, y = Sales),
name = "Sprzedanych kopii gier w Japonii"
) %>%
hc_title(
text = "Udział platform w Japonii w latach 1980-2016",
margin = 20,
align = "left",
style = list(color = "black", useHTML = TRUE)
)
par(mfrow=c(1,1))
