library(factoextra)
library(FactoMineR)
data(children)

children
## Nie wszystkie wiersze i kolumny będą użyte do tworzenia modelu
res.ca <- CA(children, row.sup = 15:18, col.sup = 6:8,
              graph = FALSE)
summary(res.ca)
fviz_ca_biplot(res.ca, repel = TRUE)
fviz_ca_biplot(res.ca, repel = TRUE,
               invisible = c("row.sup", "col.sup"))
res.ca$row
res.ca$col
res.ca$row.sup
fviz_ca_row(res.ca, repel = TRUE)
res.ca$col.sup
fviz_ca_col(res.ca, repel = TRUE)
# Visualize rows with cos2 >= 0.8
fviz_ca_row(res.ca, select.row = list(cos2 = 0.8))
# Top 5 active rows and 5 suppl. rows with the highest cos2
fviz_ca_row(res.ca, select.row = list(cos2 = 5))
# Select by names
name <- list(name = c("employment", "fear", "future"))
fviz_ca_row(res.ca, select.row = name)
# Top 5 contributing rows and columns
fviz_ca_biplot(res.ca, select.row = list(contrib = 5),
               select.col = list(contrib = 3)) +
    theme_minimal()
